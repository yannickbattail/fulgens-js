<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ailurus</title>
    <link rel="icon" href="img/fulgens.svg">
    <link rel="stylesheet" type="text/css" href="css/fulgens.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="js/ailurus-api.js"></script>
    <script src="js/ailurus-mocked-api.js"></script>
    <script src="js/main.js"></script>
    <script src="js/fulgens.js"></script>
    <script src="js/FulgensMap.js"></script>
</head>
<body>
    <h2><img src="img/fulgens.svg" alt="fulgens icon" width="50" height="50" /> Ailurus fulgens</h2>
    <div id="loginBox">
        <table>
            <tr>
                <th><label for="playerName">Player name</label></th>
                <td><input type="text" id="playerName" /></td>
            </tr>
            <tr>
                <th><label for="pass">Pass</label></th>
                <td><input type="password" id="pass" /></td>
            </tr>
            <tr>
                <th><label for="hurle">URL</label></th>
                <td><input type="text" id="hurle" value="http://localhost:61218/" /></td>
            </tr>
            <tr>
                <td colspan="2" id="loginMsg"></td>
            </tr>
            <tr>
                <th><input type="button" id="login" value="Login" /></th>
                <td><input type="button" id="createPlayer" value="create player" /></td>
            </tr>
        </table>
    </div>

    <div id="gui">
        <div onclick="$('#tuto').show();" style="text-decoration: underline; color:#10a54a">Show tuto</div>
        <div id="tuto" class="tuto">
            <div>
                <img src="img/fulgens.svg" alt="fulgens icon" width="20" height="20" />
                Tuto
                <button onclick="$('#tuto').hide();">X</button>
            </div>
            <div id="tuto_page0" class="tuto_page">
                <h3>Welcome to AIlurus Fulgens</h3> a coding game where you build your AI.<br />
                Why the name AIlurus Fulgens?<br />
                It's the latin name of the specie of the cute red panda.
                <img src="img/fulgens.svg" alt="fulgens icon" width="20" height="20" /><br />
                It also begin with <b>AI</b> for <b>A</b>rtificial <b>I</b>ntelligence.<br />
                <div>
                    <button onclick="$('#tuto_page0').hide();$('#tuto_page1').show();">next</button>
                </div>
            </div>
            <div id="tuto_page1" class="tuto_page" style="display: none;">
                <h3>AIlurus Fulgens project</h3>
                <b>Ailurus</b> is server, the part of the project that manage the maps and the drones of every players<br />
                <b>Fulgens</b> is client, the graphic interface where you AI runs.
                <div>
                    <button onclick="$('#tuto_page1').hide();$('#tuto_page0').show();">previous</button>
                    <button onclick="$('#tuto_page1').hide();$('#tuto_page2').show();">next</button>
                    
                </div>
            </div>
            <div id="tuto_page2" class="tuto_page" style="display: none;">
                <h3>The Blocks in this page</h3><br />
                <ul>
                    <li>Map</li> display of the map Factories, mines and your drones.<br />
                    <li>Drones</li> status and position of your drones, progression of the current instruction.<br />
                    <li>Map info</li> description of the map and quantity of resources to finish the level.<br />
                    <li>Player</li> player stats and current quantity of resources int the factory.<br />
                    <li>Manual action</li> a small form to manualy send instructions to you drones.<br />
                    <li>Output</li> output of the execution of you code.<br />
                    <li>AI code</li> the code of you IA.
                </ul>
                <div>
                    <button onclick="$('#tuto_page2').hide();$('#tuto_page1').show();">previous</button>
                    <button onclick="$('#tuto_page2').hide();$('#tuto_page3').show();">next</button>
                </div>
            </div>
            <div id="tuto_page3" class="tuto_page" style="display: none;">
                <h3>AilurusApi</h3>
                how to get map and drone info and send instructions<br />
                <b>Send instructions:</b><br />
                <code>ailurusApi.instructions(instructions , fctOnSuccess, fctOnError);</code><br />
                Instructions: <code>[{'TYPE': 'MoveTo', 'DroneName': 'Drone_1','Destination': {"X":45, "Y":45}}];</code><br />
                TYPE can be : MoveTo, Unload or Collect<br />
                <br />
                <b>Get map info:</b><br />
                <code>ailurusApi.map(function (map) { doSomthingWithTheMap(map);}, fctOnError);</code><br />
                <br />
                <b>Get player and drones info:</b><br />
                <code>ailurusApi.playerContext(function (player) { doSomthingWithThePlayer(player);}, fctOnError);</code><br />
                <br />
                For more info see: <a href="https://github.com/yannickbattail/fulgens-js/blob/master/docs/ailurus-api.md">https://github.com/yannickbattail/fulgens-js/blob/master/docs/ailurus-api.md</a>
                <div>
                    <button onclick="$('#tuto_page3').hide();$('#tuto_page2').show();">previous</button>
                    <button onclick="$('#tuto_page3').hide();$('#tuto_page4').show();">next</button>
                </div>
            </div>
            <div id="tuto_page4" class="tuto_page" style="display: none;">
                <h3>Fulgens functions</h3>
                Schedule and repeat task<br />
                Execute <i>theFunction</i> after <i>timeout</i> milliseconds<br />
                <code>var timeoutID = Fulgens.setTimeout(theFunction, timeout);</code>
                <br />
                Repeat (call) <i>theFunction</i> every <i>interval</i> milliseconds<br />
                <code>var intervalID = Fulgens.setInterval(theFunction, interval);</code>
                <br />
                Abort timeout or interval (the 2 previous functions)<br />
                <code>Fulgens.clearTimeout(timeoutID);</code><br />
                <code>Fulgens.clearTimeout(intervalID);</code><br />
                <br />
                <b>Note:</b> these function behave the same as window.setTimeout() and window.setInterval()<br />
                But it's important to use them, because without them the buttons "stop" and "start" won't work.<br />
                <br />
                For more info see: <a href="https://github.com/yannickbattail/fulgens-js/blob/master/docs/fulgens.md">https://github.com/yannickbattail/fulgens-js/blob/master/docs/fulgens.md</a>
                <div>
                    <button onclick="$('#tuto_page4').hide();$('#tuto_page3').show();">previous</button>
                </div>
            </div>
        </div>

        <div class="block">
            <div class="collapse">Map</div>
            <div class="block-body" id="">
                    <canvas id="canvas" width="100" height="100"></canvas>
            </div>
        </div>

        <div class="block">
            <div class="collapse">Drones</div>
            <div class="block-body" id="stats">

            </div>
        </div>

        <div class="block">
            <div class="collapse">Map information</div>
            <div class="block-body" id="goal">

            </div>
        </div>

        <div class="block">
            <div class="collapse">Player</div>
            <div class="block-body" id="playerContext">

            </div>
        </div>
        
        <div class="block">
            <div class="collapse">Manual action</div>
            <div class="block-body">
                Drone: <select id="Drone">
                    <option>Drone_1</option>
                    <option>Drone_2</option>
                </select>
                <br /> 
                Action: <select id="TYPE">
                    <option value="Collect">Collect</option>
                    <option value="Unload">Unload</option>
                    <option value="MoveTo">Move to</option>
                </select>
                <br />
                <select id="Destination">
                    <option value="4,4">Factory</option>
                    <option value="45,45">Gold Mine</option>
                </select>
                <br />
                <input type="button" id="doIt" value="Do it!" />
            </div>
        </div>

        <div class="block">
            <div class="collapse">Output</div>
            <div class="block-body" id="out">
                output
            </div>
        </div>

        <div class="block">
            <div class="collapse">AI Code</div>
            <div class="block-body" id="playerContext">
                <textarea id="code">

var instruction = {};
instruction['TYPE'] = 'MoveTo';
instruction['DroneName'] = 'Drone_1';
instruction['Destination'] = {"X":45, "Y":45};

var instructionList = [instruction];
ailurusApi.instructions(instructionList, function (response) {
    $('#out').html(response);
});

function logResult(response) {
    $('#out').html(response);
}

function collectDrone_1()
{
    var instruction = {
        'TYPE': 'Collect',
        'DroneName': 'Drone_1',
        'Destination': null
    };
    ailurusApi.instructions([instruction], logResult);
}

Fulgens.setTimeout(collectDrone_1, 2*60*1000); // 2min in ms

                </textarea>
                <br />
                <input type="button" id="run" value="run" />
                <input type="button" id="stop" value="stop" />
            
            </div>
        </div>
    </div>
</body>
<script>
    Gui();

$(".collapse").click(function () {
    var header = $(this);
    var content = header.next();
    content.slideToggle(500, function () {
        header.toggleClass('collapsed');
    });
});
</script>
</html>